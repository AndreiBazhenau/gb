[Глубокое обучение в компьютерном зрении](https://gb.ru/study_groups/12315)
---

## 1. Обработка изображений и компьютерное зрение

???

- **hw_1.ipynb** -  Напишите на Python реализацию как минимум одного алгоритма на выбор: любая на выбор цветовая обработка, перевод в другое цветовое пространство или фильтрация. Изображение выберите самостоятельно.

## 2. Свёрточные нейронные сети

???

- **hw_2.ipynb** - Реализовать и обучить (с нуля) свёрточную нейронну сеть СНС для задачи классификации изображений на датасете CIFAR-10 (tf.keras.datasets.cifar10)

## 3. Продвинутые архитектуры свёрточных нейросетей
- **DL in CV [3] Продвинутые архитектуры свёрточных нейросетей.pptx**
   - Свёрточная нейронная сеть
   - Свёртка со страйдом
   - Регуляризация
      - Droput
      - Weight Decay (L2)
      - Нормализация батча (batchnorm) с формулами
   - Датасет Imagenet
   - AlexNet 2012
   - ZF Net (2013)
   - VGG (2014), VGG-16, VGG-19
   - Spatial Pyramid Pooling (2014) - пространственный пирамидальный пулинг: решение проблемы картинок разного размера
   - GoogleNet / Inception (2014)
   - Inception-V3
   - ResNet (2015)
   - Inception-ResNet-V2 (2016)
   - Аугментация данных: обучение и инференс
   - Transfer Learning
- **3_1_Advanced_CNN.ipynb** - продвинутые свёрточные нейронные сети классификации кошек и собак (датасет tfds) на TensorFlow
   - Создание пайплайна данных
   - Создание собственного слоя: Conv + BatchNorm + ReLU: свёртка + батч-нормализация + активация ReLU
   - Создание модели CNN
   - Регуляризация свёрточных сетей:
     - Dropout - для полносвязных слоёв
     - Batch Normalization - для свёрточных слоёв
     - Weight Decay (L2) - для всех слоёв с параметрами
   - TensorBoard
- **3_2_Transfer_Learning.ipynb** - три варианта дообучения классификации картинок кошек и собак (датасет tfds) на TensorFlow и архитектуре **MobileNet**. В MobileNet применяются различные трюки для ускорения работы сети.
   1. Обучение модели с нуля без предобучения
   2. Transfer learning - веса предобученной модели заморозим т.е. не будем дообучать
   3. Transfer learning - веса предобученной модели будем дообучать - это называется **fine tuning**.
- **hw_3** - Обучить свёрточную нейронную сеть (СНС) с помощью Transfer Learning на датасете Food-101. Использовать тонкую настройку существующей предобученной модели и методы аугментации данных.

## 4. Сегментация
- Задачи в компьютерном зрении:
  - Классификация - label - предсказываем ЧТО изображено на картинке
  - Локализация: bounding box + label - предсказываем ЧТО изображено и примерное положение объекта с помощью ограничивающего прямоугольника bounding box
  - Локализация: тепловая карта - heatmap
  - Детектирование объектов (если объектов несколько и каждый классифицируем и определяем положение с помощью bounding box)
  - Семантическая сегментация (**semantic segmentation**) - классифицируем каждый пиксель картинки семантически (разделяем только по классам - кошки/собаки) к тому или иному сегменту - есть точные контуры каждого объекта.
  - Сегментация объектов (**instance segmentation**) - отделяем объекты внутри одно класса
- Методы классической сегментации
  - Суперпиксели
  - Условные случайные поля (conditional random fields - CRF)
  - Скользящее окно
- Методы глубокого обучения
    - Полносвёрточная сеть (FCN)
    - Получение тепловой карты с помощью FCN
    - FCN + ArgMax
  - FCN + Upscale + ArgMax
  - Loss для сегментации
- Методы улучшения FCN модели
  - FCN + Upscale
  - Свёртка со страйдом (Strided Conv) - обучаемый пулинг
  - Слои для повышения разрешения:
    - Unpooling слой
    - Max unpooling
    - Транспонированная свёртка Upconv и её свойства
    - Транспонированная свёртка Upconv со страдом эквивалентна sparse unpooling + стандартная свёртка
  - Skipped connections - проброшенные связи (как в ResNet и U-Net)
  - Дилатационная (перфорированная) свёртка (Dilated, Atrous)
  - Atrous spatial pyramid pooling (ASPP)
  - Постобработка: DL + CFR с суперпикселями

- **4_1_Segmentation_Unet.ipynb** - пример сегментации на основе сети близкой к U-Net. Пример на 2-х картинках. Задача - отладить процесс построения и обучения модели с точки зрения алгоритма и архитектуры.
- **4_2_Segmentation_ASPP.ipynb** - мощная модель нейронной сети ASPP с делатационными свёртками которая увеличивает рецептивное поле для сегментации.
- **4_3_Segmentation_COCO.ipynb** - В ноутбуке пример создания пайплайна данных для датасета COCO (command objects in context).
- **hw_4.ipynb** - Обучение модели семантической сегментации (человек-vs-фон) на подмножестве датасета MS COCO. Обучение проводилось на Kaggle из-за того , что Colab был не доступен.

## 5. Детектирование объектов

Задачи:
- Детектирование лиц и людей
- Детектирование продуктов
- Автономные транспортные средства

Сети для детектирования объектов:
- Region proposals - получение кандидатов bounding box
  - Selective search основанный на суперпикселях
  - Edge boxes
- Семейство R-CNN (сначала извлечение proposal, а потом работа с каждым proposal):
  - R-CNN - Region Convolution Neural Network
  - Fast R-CNN
  - Faster R-CNN
- Семейство SSD / YOLO (за один проход - детекция объектов):
  - YOLO - You Only Look Once
  - SSD - Single Shot Multibox Detector
- Single Shot Multibox Detector (SSD)
- Сравнение архитектур по качеству и скорости
- Mask R-CNN для сегментации - находит bouning box, метку класса и обрамление сегментации
- **5_1_Classification_and_Localization.ipynb** - Классификация и одновременная локализация с помощью ограничивающего прямогоугольника на примере датасета MNIST. Генерируются фоны из случайного шума и на них накладываются цыфры из MNIST, которые распознаются и локализуются через bounding boxes.
- **5_2_Object_Detection.ipynb** - Детектирование объектов с помощью предобученой на датасете COCO сети Keras RetinaNet. Для детекции объектов используется собстенноручно-созданный и размеченный датасет фотографий кубика.
- **hw_5.ipynb** - детектирование объектов на основе TensorFlow Object Detection API и модели обученной на COCO датасете.

## 6. Metric Learning или обучение эмбеддингов
- Embedding (вложение)
- Эмбеддинг как дескриптор
- Кластеризация объектов
- Обучение эмбедингов
- Metric Learning
- Сиамская нейронная сеть
- Евклидово и косинусное расстояние
- Лоссы:
  - SoftMax
  - Contrastive Loss
  - Triplet Loss
  - Center Loss
  - SphereFace
  - ArcFace
- One-shot Learning
- Few-shot Learning
- Zero-shot Learning
- Поиск ближайших соседей
- Locality-Sensitive Hash (LSH)
- Кластеризация изображений
- Верификация лиц
- Поиск похожих изображений
- Мультимодальные эмбеддинги
- Семантический поиск изображений

- **hw_6.ipynb** - Обучение сиамской сети TesorFlow для верификации лиц на датасете LFW - Labelled Faces in the Wild.

## 7. Обработка видео
- 1. Покадровая обработка
  - Классификация кадра
  - Детектирование объектов
  - Классификация видео
- 2. Обработка видео с помощью рекурентных нейронных сетей
  - Обработка последовательностей
  - Типы обработки последовательностей
    - Many-to-One
    - Many-to-Many
  - Двунаправленные RNN (Bidirectional RNN)
- 3. Трёхмерные свёрточные сети - 3D Convolution - трёхмерная свёртка
- 4. Вектора движения. Метод поиска векторов движения -  оптический поток.
  - Виды векторов движения: разреженные (sparse) и плотные (dense) 
- Двухканальная обработка (Two stream)

**7_Video.ipynb** - Классификация действий по видео на датасете KTH. KTH - Это Recognition of human actions - распознавание действий человека. Классификация производится не покадрово, а видео рассматривается как единый объект.

**hw_7.ipynb** - обучение нейронной сеть для распознавания действий человека по видео на датасете KTH (то же самое, что и **7_Video.ipynb**)

# 8. Синтез изображений

- Синтез текстур и перенос стиля
- Автоэнкодеры
  - Свёрточный автоэнкодер
  - Denoising автоэнкодер (очистка от шума)
  - Super-Resolution (супер-разрешение)
  - Вариационный автоэнкодер (VAE)
- Интерполяция в латентном пространстве
- Генеративные состязательные сети (GAN)

**8_1_Generation_VAE.ipynb**  - вариационный автоэнкодер VAE  - синтез цифр с предварительным обучением на датасете MNIST.

**8_2_Generation_GAN.ipynb** - синтез цифр обученными на датасете MNIST двумя вариантами ганов - полносвязным GAN и DCGAN - Deep Convolutional GAN.

**hw_8.ipynb** - реализация синтезирования лиц из LFW с помощью DCGAN.