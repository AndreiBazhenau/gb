# Курсовой проект по курсу "Базы данных"

## Задание: описать модель хранения данных популярного веб-сайта: кинопоиск, booking.com, wikipedia, интернет-магазин, geekbrains, госуслуги...

### Требования к курсовому проекту:

1. Составить общее текстовое описание БД и решаемых ею задач;

2. минимальное количество таблиц - 10;

3. скрипты создания структуры БД (с первичными ключами, индексами, внешними ключами);

4. создать ERDiagram для БД; скрипты наполнения БД данными;

5. скрипты характерных выборок (включающие группировки, JOIN'ы, вложенные таблицы);

6. представления (минимум 2);

7. хранимые процедуры / триггеры.

   ---------------------------------------------------------

## В рамках выполнения курсового проекта спроектирована база данных художественных фильмов (аналог kinopoisk.ru)

1. Разработано 12 таблиц  для хранения следующей информации:
- фильмы:
	- название
	- девиз
	- жанр
	- бюджет
	- годе выпуска
	- длительность фильма 
	- завоёванные награды на фестивалях
	- прочие параметры.
- Съёмочная группа:
	- имя и фамилия
	- день рождения
	- место рождения
	- пол
	- должность: актёр/режиссёр/оператор
- Пользователи сайта:
	- id
	- e-mail
	- имя и фамилия
	- день рождения
- Система отзывов и оценок
- Рейтинг фильма
- Ссылки на внешние ресурсы:
	- постеры
	- трейлеры
	- фото
- Награды фильма.

4. База данных заполнена данными с помощью сайта filldb.info.
5. Кроме хранения информации о фильмах и съёмочных группах, реализовано хранение информации о пользователях системы. Создана система хранения отзывов и оценок фильмов пользователями. При добавлении отзыва на фильм рейтинг фильмов автоматически перерасчитывается на основе оценок в отзыве. 
6. Реализовано наполнение сопутствующими материалами - трейлеры и постеры к фильму.
7. Создана [ERDiagram](ERDiagram.png) для БД.
8. Написаны скрипты характерных выборок:
   - Запрос года выхода и жанра по названию фильма

   - Запрос всех людей, принимавших участие в съёмках фильма

   - Запрос фильмов, вышедших после 2010 года и их жанров  (применение JOIN)

   - Запрос среднего рейтинга фильма по его оценкам  (агрегатная функция, оконная функция, группировка)

   - Запрос длительности фильмов с длительностью больше среднего (вложенный запрос, агрегатная функция)
9. Созданы представления:
- для отображения прибыльности фильма
- для отображения режиссёров и снятых ими фильмов
10. Создана хранимая процедура для заполнение таблицы media внешними ссылками на постеры, трейлеры и фотографии
11. Создан триггер для обновления рейтинга фильмов. Триггер срабатывает каждый раз при добавлении нового отзыва в таблице review. Триггер:
- Рассчитывает среднее арифметическое из оценок (mark) таблицы review
- Сохраняет новую оценку в kinopoisk_rating таблицы raiting.

